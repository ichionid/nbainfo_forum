<?php
/**
 *@file contains the configuration settings for the Upright Music Player
 */
function user_menu_dropdown_admin_settings_form($form, &$form_state) {
  $roles_int_index = user_roles();
  foreach ($roles_int_index as $key=>$value) {
    $roles_int_index[$key]['#attributes'] = roles_int_indexarray('checked' => 'checked');
  }

  /*$roles_string_index = array();
  $current_roles_state = variable_get('user_menu_dropdown_selected_roles', array());

  foreach($roles_int_index as $key=>$value) {
    $roles_string_index[$value] = (isset($current_roles_state[$value]) 
        && ($current_roles_state[$value] == 1 
        || $current_roles_state[$value] == 0)
      ) ? $current_roles_state[$value] : 0;
  }*/
  dpm(user_roles());
  $form['selected_roles'] = array(
    '#type' => 'checkboxes',
    '#options' => user_roles(),
    '#title' => t('Roles of the users you would like to include in the drop down link'),
  );
  $form['submit'] = array(
    '#type' => t('submit'),
    '#value' => t('Save settings'),
  );
  return $form;
}

/*function up_admin_settings_form_validate($form, &$form_state) {
}*/

function user_menu_dropdown_admin_settings_form_submit($form, &$form_state) {

  variable_set('user_menu_dropdown_selected_roles', $form_state['values']['select_roles']);
  drupal_set_message(t('The settings have been saved!'));

}

